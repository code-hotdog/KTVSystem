{"remainingRequest":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\src\\views\\login.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\src\\views\\login.vue","mtime":1585972675000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport wsmLoading from \"@/plugins/wsmLoading\";\nimport jwt_decode from 'jwt-decode';\nexport default {\n  name: \"login\",\n  data: function data() {\n    var _this = this;\n\n    var validateCaptcha = function validateCaptcha(rule, value, callback) {\n      if (!_this.inputCaptcha.trim().length) {\n        callback(new Error('请输入验证码~'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      inline: true,\n      inlinemessage: false,\n      loginForm: {\n        email: \"\",\n        password: \"\"\n      },\n      loginRule: {\n        email: [{\n          required: true,\n          message: \"邮箱不能为空\",\n          trigger: \"blur\"\n        }, {\n          type: \"email\",\n          message: \"请输入正确的邮箱\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          required: true,\n          message: \"密码不能为空\",\n          trigger: \"blur\"\n        }, {\n          min: 6,\n          max: 20,\n          message: \"密码长度在6-20之间\",\n          trigger: \"blur\"\n        }],\n        inputCaptcha: [{\n          required: true,\n          validator: validateCaptcha,\n          trigger: \"blur\"\n        }]\n      },\n      inputCaptcha: \"\"\n    };\n  },\n  methods: {\n    // 登录\n    submitForm: function submitForm(formName) {\n      var _this2 = this;\n\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          wsmLoading.start(\"正在登录,请稍候...\");\n          setTimeout(function () {\n            if (_this2.inputCaptcha.toLowerCase() == _this2.getCookie(\"captcha\")) {\n              _this2.$axios.post(\"http://localhost:8633/api/admin/account/login\", _this2.loginForm).then(function (res) {\n                if (res) {\n                  // 解析token\n                  var token = res.data.token;\n                  localStorage.setItem(\"adminToken\", token);\n                  var decoded = jwt_decode(token); // 存储vuex中\n\n                  _this2.$store.dispatch(\"setAdminInfo\", decoded);\n\n                  _this2.$store.dispatch(\"isAdminAuthorization\", true);\n\n                  _this2.$Message.success(\"\".concat(decoded.username, \"\\u767B\\u5F55\\u6210\\u529F\"));\n\n                  wsmLoading.end();\n\n                  _this2.$router.push(\"/\");\n                }\n              }).catch(function (error) {\n                console.error(error.response);\n\n                _this2.refreshCaptcha();\n              });\n            } else {\n              wsmLoading.end();\n\n              _this2.$Modal.confirm({\n                title: \"错误\",\n                content: \"你输入的验证码有误,请重新输入验证码~\",\n                type: \"error\",\n                onOk: function onOk() {// this.refreshCaptcha();\n                }\n              });\n            }\n          }, 900);\n        }\n      });\n    },\n    // 获取验证码cookie\n    getCookie: function getCookie(cname) {\n      var name = cname + \"=\";\n      var ca = document.cookie.split(';');\n\n      for (var i = 0; i < ca.length; i++) {\n        var c = ca[i].trim();\n        if (c.indexOf(name) == 0) return c.substring(name.length, c.length);\n      }\n\n      return \"\";\n    },\n    // 刷新验证码\n    refreshCaptcha: function refreshCaptcha() {\n      this.$refs.captcha.src = \"http://localhost:8633/api/safecode?d=\" + Math.random();\n    }\n  }\n};",{"version":3,"sources":["login.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"login\">\n        <div class=\"login-title\">\n            后台管理系统\n        </div>\n        <div class=\"form-box\">\n            <el-form class=\"login-form\" label-position=\"top\" size=\"small\" :inline-message=\"inlinemessage\" :model=\"loginForm\" :rules=\"loginRule\" ref=\"loginForm\" label-width=\"100px\">\n                <el-form-item label=\"Email address\" prop=\"email\">\n                    <el-input type=\"text\" v-model=\"loginForm.email\" placeholder=\"请输入邮箱\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"Password\" prop=\"password\">\n                    <el-input type=\"password\" @keypress.enter.native=\"submitForm('loginForm')\" show-password v-model=\"loginForm.password\" placeholder=\"请输入密码\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"Security Code\" prop=\"inputCaptcha\">\n                    <div class=\"yzm\">\n                        <el-input style=\"width:150px;\" v-model=\"inputCaptcha\" placeholder=\"验证码\"></el-input>\n                        <img width=\"80\" style=\"background:#EEE9E9;margin-left:30px;\" ref=\"captcha\" height=\"32\" src=\"http://localhost:8633/api/safecode\" @click=\"refreshCaptcha\">\n                    </div>\n                </el-form-item>\n                <el-form-item>\n                    <el-button class=\"login-btn\" type=\"primary\" @click=\"submitForm('loginForm')\">Sign in</el-button>\n                </el-form-item>\n            </el-form>\n        </div>\n    </div>\n</template>\n<script>\nimport wsmLoading from \"@/plugins/wsmLoading\"\nimport jwt_decode from 'jwt-decode';\nexport default {\n    name:\"login\",\n    data(){\n        const validateCaptcha = (rule, value, callback) => {\n            if(!this.inputCaptcha.trim().length){\n                callback(new Error('请输入验证码~'));\n            }else{\n                callback();\n            }\n        }\n        return{\n            inline:true,\n            inlinemessage:false,\n            loginForm:{\n                email:\"\",\n                password:\"\"\n            },\n            loginRule:{\n                email:[\n                    {required:true,message:\"邮箱不能为空\",trigger:\"blur\"},\n                    {type:\"email\",message:\"请输入正确的邮箱\",trigger:\"blur\"},\n                ],\n                password:[\n                    {required:true,message:\"密码不能为空\",trigger:\"blur\"},\n                    {min:6,max:20,message:\"密码长度在6-20之间\",trigger:\"blur\"}\n                ],\n                inputCaptcha:[\n                    {required:true, validator:validateCaptcha,trigger:\"blur\"}\n                ]\n            },\n            inputCaptcha:\"\"\n        }\n    },\n    methods:{\n        // 登录\n        submitForm(formName){\n            this.$refs[formName].validate(valid => {\n                if(valid){\n                    wsmLoading.start(\"正在登录,请稍候...\")\n                    setTimeout(() => {\n                        if(this.inputCaptcha.toLowerCase() == this.getCookie(\"captcha\")){\n                            this.$axios.post(\"http://localhost:8633/api/admin/account/login\", this.loginForm)\n                                .then(res => {\n                                    if(res){\n                                        // 解析token\n                                        const {token} = res.data;\n                                        localStorage.setItem(\"adminToken\", token);\n                                        const decoded = jwt_decode(token);\n                                        // 存储vuex中\n                                        this.$store.dispatch(\"setAdminInfo\", decoded);\n                                        this.$store.dispatch(\"isAdminAuthorization\", true);\n                                        this.$Message.success(`${decoded.username}登录成功`)\n                                        wsmLoading.end();\n                                        this.$router.push(\"/\");\n                                    }\n                                })\n                                .catch(error => {\n                                    console.error(error.response);\n                                    this.refreshCaptcha();\n                                })\n                        }else{\n                            wsmLoading.end();\n                            this.$Modal.confirm({\n                                title:\"错误\",\n                                content:\"你输入的验证码有误,请重新输入验证码~\",\n                                type:\"error\",\n                                onOk:()=>{\n                                    // this.refreshCaptcha();\n                                }\n                            })\n                        }\n                    }, 900)\n                }\n            })\n        },\n        // 获取验证码cookie\n        getCookie(cname){\n            var name = cname + \"=\";\n            var ca = document.cookie.split(';');\n            for(var i=0; i<ca.length; i++){\n                var c = ca[i].trim();\n                if (c.indexOf(name)==0) return c.substring(name.length,c.length);\n            }\n            return \"\";\n        },\n        // 刷新验证码\n        refreshCaptcha(){\n            this.$refs.captcha.src = \"http://localhost:8633/api/safecode?d=\" + Math.random();\n        },\n    }\n}\n</script>\n<style lang=\"less\" scoped>\n.login{\n    width: 100%;\n    height: 100%;\n    cursor: default;\n    padding: 40px 0px;\n    color:red;\n    background-image: url(../assets/image/login-bg.jpg);\n    background-size: 100% 100%;\n    display: flex;\n    flex-direction: column;\n\n    .login-title{\n        width:100%;\n        height: 150px;\n        line-height: 150px;\n        text-align: center;\n        font-size: 40px;\n        color: aliceblue;\n        font-family: \"隶书\";\n    }\n\n    // 表单\n    .form-box{\n        width: 100%;\n        // min-width: 500px;\n\n        .login-form{\n            width: 300px;\n            margin: 0px auto;\n            background-color: rgba(255, 255, 255,.9);\n            border: 1px solid #cdcdcd;\n            padding: 10px 15px;\n            border-radius: 5px;\n\n            .login-btn{\n                width: 100%;\n                background: linear-gradient(to bottom, rgba(47, 228, 89, 0.9),#26a744);\n                font-weight: 600;\n            }\n            .login-btn:hover{\n                background-color: rgb(94, 255, 132);\n            }\n\n\n            // 验证码区域\n            .yzm{\n                display:flex;\n                align-content:center;\n                input{\n                    width: 160px;\n                    height: 32px;\n                    outline: none;\n                    border: 1px solid #eee;\n                    padding: 2px 15px;\n                    border-radius: 5px;\n                    font-size: 13px;\n                }\n                ::-webkit-input-placeholder{\n                    color:#bbb;\n                }\n                img:hover{\n                    cursor: pointer;\n                }\n            }\n\n        }\n    } \n}\n</style>\n"],"sourceRoot":"src/views"}]}