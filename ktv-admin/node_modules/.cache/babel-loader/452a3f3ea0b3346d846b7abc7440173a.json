{"remainingRequest":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\src\\plugins\\axios.js","dependencies":[{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\src\\plugins\\axios.js","mtime":1585972675000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nimport Vue from 'vue';\nimport axios from \"axios\";\nimport router from \"../router\";\nimport { Message } from \"view-design\";\nimport wsmLoading from \"@/plugins/wsmLoading\"; // Full config:  https://github.com/axios/axios#request-config\n// axios.defaults.baseURL = process.env.baseURL || process.env.apiUrl || '';\n// axios.defaults.headers.common['Authorization'] = AUTH_TOKEN;\n// axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\n\nvar config = {\n  // baseURL: process.env.baseURL || process.env.apiUrl || \"\"\n  timeout: 60 * 1000 // Timeout\n  // withCredentials: true, // Check cross-site Access-Control\n\n};\n\nvar _axios = axios.create(config);\n\n_axios.interceptors.request.use(function (config) {\n  // Do something before request is sent\n  if (localStorage.adminToken) {\n    config.headers.Authorization = localStorage.adminToken;\n  }\n\n  return config;\n}, function (error) {\n  // Do something with request error\n  return Promise.reject(error);\n}); // Add a response interceptor\n\n\n_axios.interceptors.response.use(function (response) {\n  // Do something with response data\n  return response;\n}, function (error) {\n  // Do something with response error\n  wsmLoading.end();\n  console.log(error.response);\n  var status = error.response.status;\n\n  if (status == 401) {\n    localStorage.removeItem(\"adminToken\");\n    Message.error({\n      content: \"密码失效,重新登录\",\n      duration: 2\n    });\n    router.push(\"/home/login\");\n  } else {\n    Message.error({\n      content: error.response.data.result,\n      duration: 1\n    });\n  }\n\n  return Promise.reject(error);\n});\n\nPlugin.install = function (Vue, options) {\n  Vue.axios = _axios;\n  window.axios = _axios;\n  Object.defineProperties(Vue.prototype, {\n    axios: {\n      get: function get() {\n        return _axios;\n      }\n    },\n    $axios: {\n      get: function get() {\n        return _axios;\n      }\n    }\n  });\n};\n\nVue.use(Plugin);\nexport default Plugin;",{"version":3,"sources":["D:/研课程/ktv-select_music-system-master/ktv-select_music-system-master/ktv-admin/src/plugins/axios.js"],"names":["Vue","axios","router","Message","wsmLoading","config","timeout","_axios","create","interceptors","request","use","localStorage","adminToken","headers","Authorization","error","Promise","reject","response","end","console","log","status","removeItem","content","duration","push","data","result","Plugin","install","options","window","Object","defineProperties","prototype","get","$axios"],"mappings":"AAAA;;AAEA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,UAAP,MAAuB,sBAAvB,C,CAEA;AACA;AACA;AACA;;AAEA,IAAIC,MAAM,GAAG;AACX;AACAC,EAAAA,OAAO,EAAE,KAAK,IAFH,CAES;AACpB;;AAHW,CAAb;;AAMA,IAAMC,MAAM,GAAGN,KAAK,CAACO,MAAN,CAAaH,MAAb,CAAf;;AAEAE,MAAM,CAACE,YAAP,CAAoBC,OAApB,CAA4BC,GAA5B,CACE,UAASN,MAAT,EAAiB;AACf;AACA,MAAGO,YAAY,CAACC,UAAhB,EAA2B;AACvBR,IAAAA,MAAM,CAACS,OAAP,CAAeC,aAAf,GAA+BH,YAAY,CAACC,UAA5C;AACH;;AACD,SAAOR,MAAP;AACD,CAPH,EAQE,UAASW,KAAT,EAAgB;AACd;AACA,SAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,CAXH,E,CAcA;;;AACAT,MAAM,CAACE,YAAP,CAAoBU,QAApB,CAA6BR,GAA7B,CACE,UAASQ,QAAT,EAAmB;AACjB;AACA,SAAOA,QAAP;AACD,CAJH,EAKE,UAASH,KAAT,EAAgB;AACd;AACAZ,EAAAA,UAAU,CAACgB,GAAX;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYN,KAAK,CAACG,QAAlB;AAHc,MAINI,MAJM,GAIKP,KAAK,CAACG,QAJX,CAINI,MAJM;;AAMd,MAAGA,MAAM,IAAI,GAAb,EAAiB;AACbX,IAAAA,YAAY,CAACY,UAAb,CAAwB,YAAxB;AACArB,IAAAA,OAAO,CAACa,KAAR,CAAc;AACVS,MAAAA,OAAO,EAAC,WADE;AAEVC,MAAAA,QAAQ,EAAC;AAFC,KAAd;AAIAxB,IAAAA,MAAM,CAACyB,IAAP,CAAY,aAAZ;AACH,GAPD,MAOK;AACDxB,IAAAA,OAAO,CAACa,KAAR,CAAc;AACZS,MAAAA,OAAO,EAACT,KAAK,CAACG,QAAN,CAAeS,IAAf,CAAoBC,MADhB;AAEZH,MAAAA,QAAQ,EAAC;AAFG,KAAd;AAIH;;AAID,SAAOT,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,CA5BH;;AA+BAc,MAAM,CAACC,OAAP,GAAiB,UAAS/B,GAAT,EAAcgC,OAAd,EAAuB;AACtChC,EAAAA,GAAG,CAACC,KAAJ,GAAYM,MAAZ;AACA0B,EAAAA,MAAM,CAAChC,KAAP,GAAeM,MAAf;AACA2B,EAAAA,MAAM,CAACC,gBAAP,CAAwBnC,GAAG,CAACoC,SAA5B,EAAuC;AACrCnC,IAAAA,KAAK,EAAE;AACLoC,MAAAA,GADK,iBACC;AACJ,eAAO9B,MAAP;AACD;AAHI,KAD8B;AAMrC+B,IAAAA,MAAM,EAAE;AACND,MAAAA,GADM,iBACA;AACJ,eAAO9B,MAAP;AACD;AAHK;AAN6B,GAAvC;AAYD,CAfD;;AAiBAP,GAAG,CAACW,GAAJ,CAAQmB,MAAR;AAEA,eAAeA,MAAf","sourcesContent":["\"use strict\";\n\nimport Vue from 'vue';\nimport axios from \"axios\";\nimport router from \"../router\";\nimport { Message } from \"view-design\";\nimport wsmLoading from \"@/plugins/wsmLoading\"\n\n// Full config:  https://github.com/axios/axios#request-config\n// axios.defaults.baseURL = process.env.baseURL || process.env.apiUrl || '';\n// axios.defaults.headers.common['Authorization'] = AUTH_TOKEN;\n// axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\n\nlet config = {\n  // baseURL: process.env.baseURL || process.env.apiUrl || \"\"\n  timeout: 60 * 1000, // Timeout\n  // withCredentials: true, // Check cross-site Access-Control\n};\n\nconst _axios = axios.create(config);\n\n_axios.interceptors.request.use(\n  function(config) {\n    // Do something before request is sent\n    if(localStorage.adminToken){\n        config.headers.Authorization = localStorage.adminToken;\n    }\n    return config;\n  },\n  function(error) {\n    // Do something with request error\n    return Promise.reject(error);\n  }\n);\n\n// Add a response interceptor\n_axios.interceptors.response.use(\n  function(response) {\n    // Do something with response data\n    return response;\n  },\n  function(error) {\n    // Do something with response error\n    wsmLoading.end();\n    console.log(error.response)\n    const { status } = error.response;\n    \n    if(status == 401){\n        localStorage.removeItem(\"adminToken\");\n        Message.error({\n            content:\"密码失效,重新登录\",\n            duration:2\n        })\n        router.push(\"/home/login\")\n    }else{\n        Message.error({\n          content:error.response.data.result,\n          duration:1\n        })\n    }\n\n\n\n    return Promise.reject(error);\n  }\n);\n\nPlugin.install = function(Vue, options) {\n  Vue.axios = _axios;\n  window.axios = _axios;\n  Object.defineProperties(Vue.prototype, {\n    axios: {\n      get() {\n        return _axios;\n      }\n    },\n    $axios: {\n      get() {\n        return _axios;\n      }\n    },\n  });\n};\n\nVue.use(Plugin)\n\nexport default Plugin;\n"]}]}