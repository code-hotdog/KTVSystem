{"remainingRequest":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\src\\views\\adminlikes.vue?vue&type=style&index=0&id=f4969e32&lang=less&scoped=true&","dependencies":[{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\src\\views\\adminlikes.vue","mtime":1585972675000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.adminlikes{\n    width: 100%;\n    height: 100%;\n    padding: 20px 60px;\n}\n",{"version":3,"sources":["adminlikes.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4QA;AACA;AACA;AACA;AACA","file":"adminlikes.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div class=\"adminlikes\">\n        <Row style=\"padding:20px 60px 20px 40px;\">\n            <Col :span=\"20\">\n                <Input prefix=\"ios-musical-notes\" clearable v-model=\"searchName\" @keypress.enter.native=\"searchSong()\" placeholder=\"按 歌名, 歌手 搜索歌曲...\" style=\"width: auto\" />\n            </Col>\n            <Col :span=\"4\" style=\"text-align:right;\">\n                <Button type=\"primary\" @click=\"getAdminLikes\">所有歌曲</Button>\n            </Col>\n        </Row>\n        <!-- 歌曲数据表 -->\n        <div style=\"width:100%;background-color:#f40;\">\n            <el-table\n                :data=\"adminLikes\"\n                class=\"song-table\"\n                style=\"width: 100%\"\n                border\n            >\n                <el-table-column\n                    type=\"index\"\n                    label=\"序号\"\n                    align=\"center\"\n                    width=\"60\">\n                </el-table-column>\n                <el-table-column\n                    prop=\"_id\"\n                    label=\"歌曲 ID\"\n                    align=\"center\"\n                    width=\"240\">\n                </el-table-column>\n                <el-table-column\n                    label=\"歌曲名\"\n                    prop=\"songName\"\n                    align=\"center\"\n                    width=\"200\">\n                </el-table-column>\n                <el-table-column\n                    prop=\"artist\"\n                    label=\"歌手\"\n                    align=\"center\"\n                    width=\"170\">\n                </el-table-column>\n                <el-table-column\n                    prop=\"src\"\n                    align=\"center\"\n                    width=\"200\"\n                    label=\"歌曲地址\">\n                </el-table-column>\n                <el-table-column\n                    align=\"center\"\n                    width=\"120\"\n                    label=\"歌曲封面\">\n                    <template slot-scope='scope'>\n                        <Avatar :src=\"'http://localhost:8633/api/music/poster?img=' + scope.row.poster\" size=\"large\" />\n                    </template>\n                </el-table-column>\n                <el-table-column\n                    align=\"center\"\n                    prop=\"language\"\n                    width=\"120\"\n                    label=\"语种\">\n                </el-table-column>\n                <el-table-column\n                    align=\"center\"\n                    prop=\"style\"\n                    width=\"120\"\n                    label=\"风格\">\n                </el-table-column>\n                <el-table-column\n                    align=\"center\"\n                    prop=\"playcount\"\n                    width=\"80\"\n                    label=\"播放次数\">\n                </el-table-column>\n                <el-table-column\n                    align=\"center\"\n                    prop=\"date\"\n                    width=\"200\"\n                    label=\"最近更新时间\">\n                </el-table-column>\n                <el-table-column\n                    prop=\"operation\"\n                    align='center'\n                    label=\"操作\"\n                    fixed=\"right\"\n                    min-width=\"100\">\n                    <template slot-scope='scope'>\n                        <el-button \n                            type=\"danger\" \n                            icon='el-icon-delete' \n                            size=\"small\"\n                            circle\n                            @click='onDeleteSong(scope.row,scope.$index)'\n                        ></el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n        </div>\n        <!-- 分页 -->\n        <Row>\n            <Col span=\"24\" style=\"text-align:right;padding:10px;\">\n                <el-pagination\n                    v-if='paginations.total > 0'\n                    :page-sizes=\"paginations.page_sizes\"\n                    :page-size=\"paginations.page_size\"\n                    :layout=\"paginations.layout\"\n                    :total=\"paginations.total\"\n                    :current-page.sync='paginations.page_index'\n                    @current-change='handleCurrentChange'\n                    @size-change='handleSizeChange'>\n                </el-pagination>\n            </Col>\n        </Row>\n        <!-- 验证密码 -->\n        <Modal draggable v-model=\"isCheckPassword\" :mask-closable=\"false\" width=\"360\">\n            <p slot=\"header\" style=\"color:#f60;\">\n                <Icon type=\"ios-information-circle\"></Icon>\n                <span>验证密码</span>\n            </p>\n            <div style=\"text-align:left;font-size:14px;\">\n                <Row>\n                    <Col span=\"18\">\n                        <Input v-model=\"inputPassword\" type=\"password\" icon=\"ios-key\" @keyup.enter.native=\"checkPwd()\"  placeholder=\"请输入管理员密码...\" style=\"width: 200px\" />\n                    </Col>\n                    <Col span=\"6\">\n                        <Button type=\"primary\" size=\"large\" @click=\"checkPwd()\">验证</Button>\n                    </Col>\n                </Row>\n            </div>\n            <div slot=\"footer\">\n            </div>\n        </Modal>\n    </div>\n</template>\n<script>\nimport wsmLoading from \"@/plugins/wsmLoading\"\nexport default {\n    name:\"adminlikes\",\n    data(){\n        return{\n            isCheckPassword:false,\n            inputPassword:\"\",\n            searchName:\"\",\n            adminLikes:[],\n            allTableData:[],\n            paginations: {  // 分页属性\n                page_index: 1, // 当前位于哪页\n                total: 0, // 总数\n                page_size: 8, // 1页显示多少条\n                page_sizes: [8, 15, 20, 25], //每页显示多少条\n                layout: \"total, sizes, prev, pager, next, jumper\" // 翻页属性\n            },\n            delRow:\"\"\n        }\n    },\n    created(){\n        this.getAdminLikes();\n    },\n    methods:{\n        // 搜索歌曲\n        searchSong(){\n            if(this.searchName.trim().length){\n                // console.log(this.searchName)\n                this.$axios.post(\"http://localhost:8633/api/admin/adminlike/search\", {\n                    searchName:this.searchName\n                }).then(res => {\n                    this.adminLikes = res.data;\n                    this.allTableData = res.data;\n                    this.setPaginations();\n                })\n            }else{\n                this.$Message.warning(\"搜索内容不能为空\");\n            }\n        },\n        checkPwd(){\n            if(this.inputPassword.trim().length){\n                this.isCheckPassword = false;\n                wsmLoading.start(\"正在验证密码,请稍候...\");\n                setTimeout(() => {\n                    this.$axios.post(\"http://localhost:8633/api/admin/islegal\",{\n                        password:this.inputPassword,\n                        email:this.$store.getters.adminInfo.email\n                    }).then(res => {\n                        if(res.data == true){\n                            this.$axios.post(\"http://localhost:8633/api/admin/adminlike/del\", this.delRow)\n                                    .then(res => {\n                                        this.$nextTick(() => {\n                                            this.getAdminLikes();\n                                            wsmLoading.end();\n                                            this.inputPassword = \"\";\n                                            this.$Message.success(\"移除成功\");\n                                        })\n                                        \n                                    }).catch(err => console.error(err))\n                        }\n                    }).catch(() => this.isCheckPassword = true)\n                }, 300)\n            }else{\n                this.isCheckPassword = false;\n                this.$Modal.warning({\n                    title:\"提示\",\n                    content:\"密码不能为空,请输入管理员口令...\",\n                    onOk:()=>{\n                        this.isCheckPassword = true;\n                    }\n                })\n            }\n        },\n        // 获取所有喜欢歌曲\n        getAdminLikes(){\n            this.$axios.get(\"http://localhost:8633/api/admin/adminlike/all\")\n                    .then(res => {\n                        this.adminLikes = res.data;\n                        this.allTableData = res.data;\n                        this.setPaginations();\n                    })\n        },\n        // 移除歌曲\n        onDeleteSong(song){\n            console.log(song)\n            this.$confirm(`你确定要移除 ${song.songName} (${song.artist}) 吗?不可恢复是否继续?`, '提示', {\n                confirmButtonText:\"确定\",\n                cancelButtonText:\"取消\",\n                type:\"warning\"\n            }).then(() => {\n                this.delRow = song;\n                this.isCheckPassword = true;\n            }).catch(() => {})\n        },\n        // 设置当前页\n        handleCurrentChange(page) {\n            // 获取当前页\n            let sortnum = this.paginations.page_size * (page - 1);\n            let table = this.allTableData.filter((item, index) => {\n                return index >= sortnum;\n            });\n            // 设置默认分页数据\n            this.adminLikes = table.filter((item, index) => {\n                return index < this.paginations.page_size;\n            });\n            this.adminLikes = table.filter((item, index) => {\n                return index < this.paginations.page_size;\n            });\n        },\n        // 改变每页条数\n        handleSizeChange(page_size) {\n            // 切换size\n            this.paginations.page_index = 1;\n            this.paginations.page_size = page_size;\n            this.adminLikes = this.allTableData.filter((item, index) => {\n                return index < page_size;\n            });\n        },\n        // 设置的分页\n        setPaginations() {\n            // 总页数\n            this.paginations.total = this.allTableData.length;\n            this.paginations.page_index = 1;\n            this.paginations.page_size = 8;\n            // 设置默认分页数据\n            this.adminLikes = this.allTableData.filter((item, index) => {\n                return index < this.paginations.page_size;\n            });\n        },\n    }\n}\n</script>\n<style lang=\"less\" scoped>\n.adminlikes{\n    width: 100%;\n    height: 100%;\n    padding: 20px 60px;\n}\n</style>"]}]}