{"remainingRequest":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\src\\views\\user_service.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\src\\views\\user_service.vue","mtime":1585972675000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\研课程\\ktv-select_music-system-master\\ktv-select_music-system-master\\ktv-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport wsmLoading from \"@/plugins/wsmLoading\"\nimport \"@/plugins/Date\"\nexport default {\n    name:\"user_service\",\n    data(){\n        return{\n            isCheckPassword:false,\n            inputPassword:\"\",\n            ruleForm:{\n                order_id:\"\",\n                startTime:\"\",\n                endTime:\"\",\n                totalMoney:''\n            },\n            card:{\n                account:'',\n                password:'',\n                money:'',\n                order_id:'',\n                currentTime:'',\n                flag:false\n            },\n            timeLong:\"\",\n            timeOptions:[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24],\n        }\n    },\n    created(){\n\n    },\n    methods:{\n        checkPwd(){\n            if(this.inputPassword.trim().length){\n                this.isCheckPassword = false;\n                wsmLoading.start(\"正在验证密码,请稍候...\");\n                 setTimeout(() => {\n                    this.$axios.post(\"http://localhost:8633/api/admin/islegal\",{\n                        password:this.inputPassword,\n                        email:this.$store.getters.adminInfo.email\n                    }).then(res => {\n                        if(res.data == true){\n                            this.ruleForm.order_id = new Date().format(\"yyyyMMddHHmmss\") + `_${Math.floor(Math.random() * 100000)}`;\n                            this.ruleForm.startTime = new Date().format(\"yyyy/MM/dd HH:mm:ss\");\n                            this.ruleForm.endTime = new Date(this.timeLong * 60 * 60 * 1000 + new Date(this.ruleForm.startTime).getTime()).format(\"yyyy/MM/dd HH:mm:ss\");\n                            this.$axios.post(\"http://localhost:8633/api/admin/account/new\", this.ruleForm)\n                                    .then(res => {\n                                        this.card = {...res.data};\n                                        this.card.flag = true;\n                                        this.card.currentTime = new Date().format(\"yyyy/MM/dd HH:mm:ss\");\n                                        this.$nextTick(() => {\n                                            this.inputPassword = \"\";\n                                            this.timeLong = \"\";\n                                            wsmLoading.end();\n                                            this.$Message.success(\"开户成功\");\n                                        })\n                                    }).catch(err => console.error(err))\n                        }\n                    }).catch(() => this.isCheckPassword = true)\n                }, 300)\n                \n            }else{\n                this.isCheckPassword = false;\n                this.$Modal.warning({\n                    title:\"提示\",\n                    content:\"密码不能为空,请输入管理员口令...\",\n                    onOk:()=>{\n                        this.isCheckPassword = true;\n                    }\n                })\n            }\n        },\n        submitForm(formName){\n            if(this.timeLong){\n                this.isCheckPassword = true;\n            }else{\n                this.$Message.warning(\"请先选择时长\");\n            }\n        },\n        \n    },\n    watch:{\n        timeLong(val){\n            this.ruleForm.totalMoney = val * 30;\n        }\n    }\n}\n",{"version":3,"sources":["user_service.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user_service.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div class=\"user_service\">\n        <el-form :model=\"ruleForm\" status-icon label-width=\"100px\" class=\"ruleform\" >\n            <el-form-item label=\"时长:\" required>\n                <el-select v-model=\"timeLong\" clearable placeholder=\"请选择时长\">\n                    <el-option\n                        v-for=\"item in timeOptions\"\n                        :key=\"item\"\n                        :value=\"item\">\n                    </el-option>\n                </el-select>\n            </el-form-item>\n            <el-form-item label=\"总金额:\">\n                <span>{{timeLong ? ruleForm.totalMoney : 0 }}元</span>\n            </el-form-item>\n            <el-form-item style=\"text-align:right;padding:20px 0px;\">\n                <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">开户</el-button>\n            </el-form-item>\n        </el-form>\n        <Row class=\"order-current\" v-if=\"card.flag\">\n            <Card style=\"width:350px\">\n                <p slot=\"title\">\n                    <Icon type=\"ios-checkmark-circle\" style=\"color:green;\" />\n                    开户成功\n                </p>\n                <a href=\"javascript:(0);\" slot=\"extra\">\n                    <Icon type=\"ios-loop-strong\"></Icon>\n                    创建时间:{{card.currentTime}}\n                </a>\n                <div style=\"padding:5px 0px;\">\n                    <Icon type=\"ios-contact\" />账号:<span style=\"padding: 0px 2px;color:#19be6b;font-weight:700;\">{{card.account}}</span>\n                </div>\n                <div style=\"padding:5px 0px;\">\n                    <Icon type=\"ios-key\" />密码:<span style=\"padding: 0px 2px;color:#19be6b;font-weight:700;\">{{card.password}}</span>\n                </div>\n                <div style=\"padding:5px 0px;\">\n                    <Icon type=\"logo-bitcoin\" />金额:<span style=\"padding: 0px 2px;color:#ed4014;font-weight:700;\">{{card.money}}元</span>\n                </div>\n                <div style=\"padding:5px 0px;\">\n                    <Icon type=\"ios-copy\" />订单编号:<span style=\"padding: 0px 2px;color:#2b85e4;\">{{card.order_id}}</span>\n                </div>\n            </Card> \n        </Row>\n\n         <!-- 验证密码 -->\n        <Modal draggable v-model=\"isCheckPassword\" :mask-closable=\"false\" width=\"360\">\n            <p slot=\"header\" style=\"color:#f60;\">\n                <Icon type=\"ios-information-circle\"></Icon>\n                <span>验证密码</span>\n            </p>\n            <div style=\"text-align:left;font-size:14px;\">\n                <Row>\n                    <Col span=\"18\">\n                        <Input v-model=\"inputPassword\" type=\"password\" icon=\"ios-key\" @keyup.enter.native=\"checkPwd()\"  placeholder=\"请输入管理员密码...\" style=\"width: 200px\" />\n                    </Col>\n                    <Col span=\"6\">\n                        <Button type=\"primary\" size=\"large\" @click=\"checkPwd()\">验证</Button>\n                    </Col>\n                </Row>\n            </div>\n            <div slot=\"footer\">\n            </div>\n        </Modal>\n    </div>\n</template>\n<script>\nimport wsmLoading from \"@/plugins/wsmLoading\"\nimport \"@/plugins/Date\"\nexport default {\n    name:\"user_service\",\n    data(){\n        return{\n            isCheckPassword:false,\n            inputPassword:\"\",\n            ruleForm:{\n                order_id:\"\",\n                startTime:\"\",\n                endTime:\"\",\n                totalMoney:''\n            },\n            card:{\n                account:'',\n                password:'',\n                money:'',\n                order_id:'',\n                currentTime:'',\n                flag:false\n            },\n            timeLong:\"\",\n            timeOptions:[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24],\n        }\n    },\n    created(){\n\n    },\n    methods:{\n        checkPwd(){\n            if(this.inputPassword.trim().length){\n                this.isCheckPassword = false;\n                wsmLoading.start(\"正在验证密码,请稍候...\");\n                 setTimeout(() => {\n                    this.$axios.post(\"http://localhost:8633/api/admin/islegal\",{\n                        password:this.inputPassword,\n                        email:this.$store.getters.adminInfo.email\n                    }).then(res => {\n                        if(res.data == true){\n                            this.ruleForm.order_id = new Date().format(\"yyyyMMddHHmmss\") + `_${Math.floor(Math.random() * 100000)}`;\n                            this.ruleForm.startTime = new Date().format(\"yyyy/MM/dd HH:mm:ss\");\n                            this.ruleForm.endTime = new Date(this.timeLong * 60 * 60 * 1000 + new Date(this.ruleForm.startTime).getTime()).format(\"yyyy/MM/dd HH:mm:ss\");\n                            this.$axios.post(\"http://localhost:8633/api/admin/account/new\", this.ruleForm)\n                                    .then(res => {\n                                        this.card = {...res.data};\n                                        this.card.flag = true;\n                                        this.card.currentTime = new Date().format(\"yyyy/MM/dd HH:mm:ss\");\n                                        this.$nextTick(() => {\n                                            this.inputPassword = \"\";\n                                            this.timeLong = \"\";\n                                            wsmLoading.end();\n                                            this.$Message.success(\"开户成功\");\n                                        })\n                                    }).catch(err => console.error(err))\n                        }\n                    }).catch(() => this.isCheckPassword = true)\n                }, 300)\n                \n            }else{\n                this.isCheckPassword = false;\n                this.$Modal.warning({\n                    title:\"提示\",\n                    content:\"密码不能为空,请输入管理员口令...\",\n                    onOk:()=>{\n                        this.isCheckPassword = true;\n                    }\n                })\n            }\n        },\n        submitForm(formName){\n            if(this.timeLong){\n                this.isCheckPassword = true;\n            }else{\n                this.$Message.warning(\"请先选择时长\");\n            }\n        },\n        \n    },\n    watch:{\n        timeLong(val){\n            this.ruleForm.totalMoney = val * 30;\n        }\n    }\n}\n</script>\n<style lang=\"less\" scoped>\n.user_service{\n    width: 100%;\n    height: 100%;\n    background-image: url(../assets/image/user_service-bg.jpg);\n    background-size: 100% 100%;\n    display: flex;\n    align-content: center;\n    justify-content: center;\n\n    .ruleform{\n        margin-top: 100px;\n        border-radius: 10px;\n        font-size: 18px;\n        font-weight: 900;\n        padding:10px 20px;\n        padding-top: 40px;\n        width:600px;\n        height: 250px;\n        background: rgba(0, 0, 0, .1);\n    }\n\n    .order-current{\n        position: fixed;\n        background-color: aqua;\n        margin-top: 380px;\n    }\n    \n}\n</style>"]}]}